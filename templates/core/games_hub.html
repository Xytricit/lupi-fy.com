{% extends "dashboardhome.html" %}
{% load static %}
{% block title %}Games - Lupify{% endblock %}

{% block content %}
<div class="games-hero" style="padding:28px 20px;margin-bottom:20px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:12px;color:#fff;text-align:center;">
    <h1 style="margin:0;font-size:2.25rem;">ðŸŽ® Games</h1>
    <p style="margin:8px 0 0;opacity:0.95;">Play quick social games, compete with friends, and earn points â€” built into Lupify.</p>
</div>

<div class="games-container" style="max-width:1200px;margin:0 auto;padding:6px 12px;">
    <!-- For You Games (populated from sessionStorage when available) -->
    <section id="gamesForYouSection" style="margin-bottom:18px;display:none;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <h2 style="margin:0;font-size:1.25rem;">Recommended Games</h2>
            <a href="{% url 'games_hub' %}" style="color:var(--primary);font-weight:500;text-decoration:none;">See all â†’</a>
        </div>
        <div id="gamesForYouContainer" style="display:flex;gap:14px;overflow-x:auto;padding-bottom:8px;"></div>
    </section>
    <div class="games-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:24px;">
        {% for game in games %}
        <a href="{% url game.url %}" style="text-decoration:none;color:inherit;">
            <div class="game-card" style="border-radius:12px;overflow:hidden;box-shadow:0 12px 30px rgba(2,6,23,0.06);transition:transform .28s ease,box-shadow .28s ease;">
                <div class="game-card-header" style="padding:36px 24px;text-align:center;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;">
                    <div class="game-emoji" style="font-size:3.6rem;margin-bottom:8px;">{{ game.emoji }}</div>
                    <h2 style="margin:0;font-size:1.25rem">{{ game.name }}</h2>
                </div>
                <div class="game-card-body" style="padding:18px;background:var(--card-bg);">
                    <p class="game-description" style="color:var(--secondary-text);margin-bottom:12px;">{{ game.description }}</p>
                    <div class="game-rules" style="background:var(--bg);padding:12px;border-radius:8px;margin-bottom:12px;">
                        {% if game.id == 'try-not-to-get-banned' %}
                            <h4 style="margin:0 0 8px;">Quick Rules</h4>
                            <ul style="margin:0;padding-left:18px;color:var(--secondary-text)">
                                <li>Chat with other players</li>
                                <li>Avoid banned words</li>
                                <li>Get banned for 1 minute if you slip up</li>
                            </ul>
                        {% else %}
                            <h4 style="margin:0 0 8px;">Quick Rules</h4>
                            <ul style="margin:0;padding-left:18px;color:var(--secondary-text)">
                                <li>Quick social game</li>
                                <li>Earn points and climb the leaderboard</li>
                            </ul>
                        {% endif %}
                    </div>
                    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
                        <span class="badge">{{ game.tag|default:'Casual' }}</span>
                        <a class="play-button" href="{% url game.url %}" style="background:var(--primary);color:#fff;padding:10px 14px;border-radius:8px;text-decoration:none;font-weight:700;">Play Now</a>
                    </div>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
</div>

<style>
/* Slight hover pop for cards */
.game-card:hover { transform: translateY(-8px); box-shadow: 0 22px 48px rgba(2,6,23,0.14); }
</style>

<script>
document.addEventListener('DOMContentLoaded', ()=>{
    try{
        const raw = sessionStorage.getItem('forYouGames');
        if(!raw) return;
        const games = JSON.parse(raw || '[]');
        if(!games || games.length===0) return;
        const sec = document.getElementById('gamesForYouSection');
        const container = document.getElementById('gamesForYouContainer');
        if(!sec || !container) return;
        container.innerHTML = '';
        games.forEach(g => {
            const el = document.createElement('a');
            el.href = '{% url "games_hub" %}';
            el.style.textDecoration = 'none'; el.style.color='inherit'; el.style.minWidth='160px'; el.style.flexShrink='0';
            el.innerHTML = `
                <div style="background:linear-gradient(135deg, #1f9cee15, #fec76f15);padding:16px;border-radius:12px;border:1px solid rgba(31,156,238,0.1);transition:all 0.3s ease;">
                    <div style="font-size:2rem;margin-bottom:8px;"><img src="{% static 'svg/game-controller.svg' %}" alt="game" style="width:36px;height:36px;display:inline-block;vertical-align:middle;"/></div>
                    <div style="font-weight:600;font-size:0.95rem;color:var(--text-dark);margin-bottom:4px;">Game #${g.object_id}</div>
                    <div style="color:var(--primary);font-weight:700;font-size:1.1rem;margin-bottom:6px;">Recommended</div>
                </div>
            `;
            container.appendChild(el);
        });
        sec.style.display = 'block';
    }catch(e){console.warn('No For You games to show', e)}
});
</script>

{% endblock %}
